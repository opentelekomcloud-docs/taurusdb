:original_name: ShowGaussMySqlProxyList.html

.. _ShowGaussMySqlProxyList:

Querying Database Proxy Instances
=================================

Function
--------

This API is used to query database proxy instances. Before calling this API:

-  Learn how to :ref:`authorize and authenticate <gaussdb_03_0001>` it.
-  Obtain the required :ref:`region and endpoint <gaussdb_00_0003>`.
-  Database proxy is unavailable for DB instances in a DeC.

URI
---

GET /v3/{project_id}/instances/{instance_id}/proxies

.. table:: **Table 1** URI parameters

   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                |
   +=================+=================+=================+============================================================================+
   | project_id      | Yes             | String          | Project ID of a tenant in a region.                                        |
   |                 |                 |                 |                                                                            |
   |                 |                 |                 | To obtain this value, see :ref:`Obtaining a Project ID <gaussdb_10_0004>`. |
   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------+
   | instance_id     | Yes             | String          | DB instance ID.                                                            |
   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------+

.. table:: **Table 2** Query parameters

   +-----------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type    | Description                                                                                                                                                                                                                           |
   +===========+===========+=========+=======================================================================================================================================================================================================================================+
   | offset    | No        | Integer | Index offset. If **offset** is set to *N*, the resource query starts from the N+1 piece of data. The value is **0** by default, indicating that the query starts from the first piece of data. The value cannot be a negative number. |
   +-----------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit     | No        | Integer | Number of records to be queried. The default value is **10**. The value must be a positive integer. The minimum value is **1** and the maximum value is **100**.                                                                      |
   +-----------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   ============ ========= ====== ===========
   Parameter    Mandatory Type   Description
   ============ ========= ====== ===========
   X-Auth-Token Yes       String User token.
   X-Language   No        String Language.
   ============ ========= ====== ===========

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameter

   +------------+--------------------------------------------------------------------------------------------------------------------------------------------+------------------+
   | Parameter  | Type                                                                                                                                       | Description      |
   +============+============================================================================================================================================+==================+
   | proxy_list | Array of :ref:`MysqlShowProxyResponseV3 <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlshowproxyresponsev3>` objects | Proxy instances. |
   +------------+--------------------------------------------------------------------------------------------------------------------------------------------+------------------+

.. _showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlshowproxyresponsev3:

.. table:: **Table 5** MysqlShowProxyResponseV3

   +----------------+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+
   | Parameter      | Type                                                                                                                       | Description                 |
   +================+============================================================================================================================+=============================+
   | proxy          | :ref:`MysqlProxyV3 <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxyv3>` object                   | Proxy instance information. |
   +----------------+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+
   | master_node    | :ref:`MysqlProxyNodeV3 <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxynodev3>` object           | Primary node information.   |
   +----------------+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+
   | readonly_nodes | Array of :ref:`MysqlProxyNodeV3 <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxynodev3>` objects | Read replica information.   |
   +----------------+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+

.. _showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxyv3:

.. table:: **Table 6** MysqlProxyV3

   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | Parameter                  | Type                                                                                                                     | Description                                                                                        |
   +============================+==========================================================================================================================+====================================================================================================+
   | pool_id                    | String                                                                                                                   | Proxy instance ID.                                                                                 |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | status                     | String                                                                                                                   | Operating status of the proxy instance. It can be either of the following:                         |
   |                            |                                                                                                                          |                                                                                                    |
   |                            |                                                                                                                          | -  **ACTIVE**: The database proxy is normal.                                                       |
   |                            |                                                                                                                          | -  **FAILED**: The database proxy fails to be created.                                             |
   |                            |                                                                                                                          | -  **DELETED**: The database proxy is deleted.                                                     |
   |                            |                                                                                                                          | -  **ABNORMAL**: The database proxy is abnormal.                                                   |
   |                            |                                                                                                                          | -  **ENABLING PROXY**: The database proxy is being enabled.                                        |
   |                            |                                                                                                                          | -  **DISABLING PROXY**: The database proxy is being disabled.                                      |
   |                            |                                                                                                                          | -  **ADDING PROXY NODE**: Nodes are being added to the database proxy.                             |
   |                            |                                                                                                                          | -  **DELETING READ REPLICAS FROM PROXY**: Read replicas are being removed from the database proxy. |
   |                            |                                                                                                                          | -  **ADDING READ REPLICAS TO PROXY**: Read replicas are being added to the database proxy.         |
   |                            |                                                                                                                          | -  **CHANGING WEIGHT**: The weights of read replicas for the database proxy are being changed.     |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | address                    | String                                                                                                                   | Proxy read/write splitting address.                                                                |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | port                       | Integer                                                                                                                  | Proxy port information.                                                                            |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | pool_status                | String                                                                                                                   | Proxy instance status. Value: **ACTIVE**, **ABNORMAL**, **FAILED**, or **DELETED**.                |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | delay_threshold_in_seconds | Integer                                                                                                                  | Delay threshold in seconds.                                                                        |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | elb_vip                    | String                                                                                                                   | Virtual IP address in ELB mode.                                                                    |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | eip                        | String                                                                                                                   | EIP information.                                                                                   |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | vcpus                      | String                                                                                                                   | Number of vCPUs of the proxy instance.                                                             |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | ram                        | String                                                                                                                   | Memory size of the proxy instance.                                                                 |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | node_num                   | Integer                                                                                                                  | Number of proxy nodes.                                                                             |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | mode                       | String                                                                                                                   | Primary/standby proxy. The value is **Cluster**.                                                   |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | nodes                      | Array of :ref:`MysqlProxyNodes <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxynodes>` objects | Proxy node information.                                                                            |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | flavor_ref                 | String                                                                                                                   | Proxy specifications.                                                                              |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | name                       | String                                                                                                                   | Proxy instance name.                                                                               |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+
   | transaction_split          | String                                                                                                                   | Whether the proxy transaction splitting is enabled. Value: **ON** or **OFF**.                      |
   +----------------------------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------+

.. _showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxynodes:

.. table:: **Table 7** MysqlProxyNodes

   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | Parameter   | Type    | Description                                                                                                          |
   +=============+=========+======================================================================================================================+
   | id          | String  | Proxy node ID.                                                                                                       |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | status      | String  | Proxy node status. Value: **ACTIVE**, **ABNORMAL**, **BUILD**, or **FAILED**.                                        |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | name        | String  | Proxy node name.                                                                                                     |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | role        | String  | Role of the proxy node. It can be **master** or **slave**.                                                           |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | az_code     | String  | AZ.                                                                                                                  |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+
   | frozen_flag | Integer | Whether the proxy node is frozen. It can be **0** (unfrozen), **1** (frozen), or **2** (deleted after being frozen). |
   +-------------+---------+----------------------------------------------------------------------------------------------------------------------+

.. _showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxynodev3:

.. table:: **Table 8** MysqlProxyNodeV3

   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | Parameter         | Type                                                                                                                             | Description              |
   +===================+==================================================================================================================================+==========================+
   | id                | String                                                                                                                           | Node ID.                 |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | instance_id       | String                                                                                                                           | DB instance ID.          |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | status            | String                                                                                                                           | Node status.             |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | name              | String                                                                                                                           | Node name.               |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | weight            | Integer                                                                                                                          | Read weight of the node. |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+
   | availability_zone | Array of :ref:`MysqlProxyAvailable <showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxyavailable>` objects | AZ information.          |
   +-------------------+----------------------------------------------------------------------------------------------------------------------------------+--------------------------+

.. _showgaussmysqlproxylist__en-us_topic_0000001216000914_response_mysqlproxyavailable:

.. table:: **Table 9** MysqlProxyAvailable

   =========== ====== ===============
   Parameter   Type   Description
   =========== ====== ===============
   code        String AZ code.
   description String AZ description.
   =========== ====== ===============

**Status code: 400**

.. table:: **Table 10** Response body parameters

   ========== ====== ==============
   Parameter  Type   Description
   ========== ====== ==============
   error_code String Error code.
   error_msg  String Error message.
   ========== ====== ==============

**Status code: 500**

.. table:: **Table 11** Response body parameters

   ========== ====== ==============
   Parameter  Type   Description
   ========== ====== ==============
   error_code String Error code.
   error_msg  String Error message.
   ========== ====== ==============

Example Request
---------------

.. code-block:: text

   GET https://gaussdb-mysql.eu-de.otc.t-systems.com/v3/054e292c9880d4992f02c0196d3ea468/instances/096c0fc43e804757b59946b80dc27f8bin07/proxies?offset=0&limit=10

Example Response
----------------

**Status code: 200**

Success.

.. code-block::

   {
     "proxy_list" : [ {
       "proxy" : {
         "pool_id" : "2e7cf21d14794bafab623a334efd9ad8po01",
         "status" : "ACTIVE",
         "address" : "192.168.125.69",
         "port" : 3306,
         "pool_status" : "ACTIVE",
         "delay_threshold_in_seconds" : 30,
         "elb_vip" : "192.168.125.60",
         "eip" : "192.168.125.50",
         "vcpus" : 4,
         "ram" : 8,
         "node_num" : 2,
         "mode" : "Cluster",
         "nodes" : [ {
           "id" : "db53a238a02240c49365e72e284a4890pn01",
           "name" : "PROXY-2e7cf21d14794bafab623a334efd9ad8po01_0",
           "role" : "master",
           "az_code" : "eu-de-01",
           "status" : "ACTIVE",
           "frozen_flag" : 0
         } ],
         "name" : "proxy-name",
         "flavor_ref":"gaussdb.proxy.large.x86.2",
         "transaction_split":"OFF"
       },
       "master_node" : {
         "id" : "c01a5645eb2c4fb6a9373542f5366e50no07",
         "instance_id" : "096c0fc43e804757b59946b80dc27f8bin07",
         "status" : "ACTIVE",
         "name" : "taurus_mysql80_x86-ondemand-2-1U4G_1_202103070251274842281_node01",
         "weight" : 0,
         "availability_zone" : [{
           "code" : "eu-de-01",
           "description": "AZ1"
         }]
       },
       "readonly_nodes" : {
         "id" : "d23535333138462880bfa1838fdfced2no07",
         "instance_id" : "7a871d6d494e4327ad2e326afb591108in07",
         "status" : "ACTIVE",
         "name" : "taurus_mysql80_x86-ondemand-2-1U4G_1_202103070251274842281_node02",
         "weight" : 100,
         "availability_zone" : [{
           "code" : "eu-de-01",
           "description": "AZ1"
         }]
       }
     } ]
   }

Status Code
-----------

For details, see :ref:`Status Codes <gaussdb_10_0002>`.

Error Code
----------

For details, see :ref:`Error Codes <gaussdb_10_0003>`.
