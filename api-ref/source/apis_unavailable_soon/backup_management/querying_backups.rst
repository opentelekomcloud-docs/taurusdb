:original_name: gaussdb_11_0023.html

.. _gaussdb_11_0023:

Querying Backups
================

Function
--------

This API is used to query backups according to search criteria. Before calling this API:

-  Learn how to :ref:`authorize and authenticate <gaussdb_03_0001>` it.
-  Obtain the required :ref:`region and endpoint <gaussdb_00_0003>`.

URI
---

-  URI format

   GET https://{endpoint}/mysql/v3/{project_id}/backups?instance_id={instance_id}&backup_id={backup_id}&backup_type={backup_type}&offset={offset}&limit={limit}&begin_time={begin \_time}&end_time={end_time}

-  Example

   GET https://gaussdb-mysql.eu-de.otc.t-systems.com/mysql/v3/97b026aa9cc4417888c14c84a1ad9860/backups?instance_id=c3ec2c6148ad4d71b1a8411a62df0d3cin07&backup_id=43e4feaab48f11e89039fa163ebaa7e4br01&backup_type=auto&offset=0&limit=10&begin_time=2020-07-06T10:41:14+0800&end_time=2020-07-16T10:41:14+0800

-  Parameter description

   .. table:: **Table 1** Parameter description

      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Name            | Type            | Mandatory       | Description                                                                                                                                                                                                                           |
      +=================+=================+=================+=======================================================================================================================================================================================================================================+
      | project_id      | String          | Yes             | Project ID of a tenant in a region.                                                                                                                                                                                                   |
      |                 |                 |                 |                                                                                                                                                                                                                                       |
      |                 |                 |                 | To obtain this value, see :ref:`Obtaining a Project ID <gaussdb_10_0004>`.                                                                                                                                                            |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | instance_id     | String          | No              | DB instance ID.                                                                                                                                                                                                                       |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | backup_id       | String          | No              | Backup ID.                                                                                                                                                                                                                            |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | backup_type     | String          | No              | Backup type. Value:                                                                                                                                                                                                                   |
      |                 |                 |                 |                                                                                                                                                                                                                                       |
      |                 |                 |                 | -  **auto**: automated full backup                                                                                                                                                                                                    |
      |                 |                 |                 | -  **manual**: manual full backup                                                                                                                                                                                                     |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | offset          | String          | No              | Index offset. If **offset** is set to *N*, the resource query starts from the N+1 piece of data. The value is **0** by default, indicating that the query starts from the first piece of data. The value cannot be a negative number. |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | limit           | String          | No              | Number of records to be queried. The default value is **100**. The value must be a positive integer. The minimum value is **1** and the maximum value is **100**.                                                                     |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | begin_time      | String          | No              | Query start time. The format is "yyyy-mm-ddThh:mm:ssZ".                                                                                                                                                                               |
      |                 |                 |                 |                                                                                                                                                                                                                                       |
      |                 |                 |                 | **T** is the separator between the calendar and the hourly notation of time. **Z** indicates the time zone offset.                                                                                                                    |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | end_time        | String          | No              | Query end time. The format is "yyyy-mm-ddThh:mm:ssZ" and the end time must be later than the start time.                                                                                                                              |
      |                 |                 |                 |                                                                                                                                                                                                                                       |
      |                 |                 |                 | **T** is the separator between the calendar and the hourly notation of time. **Z** indicates the time zone offset.                                                                                                                    |
      +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 2** Request header parameters

   +--------------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                                                                                                             |
   +==============+===========+========+=========================================================================================================================================================================================+
   | X-Auth-Token | No        | String | User token.                                                                                                                                                                             |
   +--------------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | X-Language   | No        | String | Language.                                                                                                                                                                               |
   +--------------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Content-Type | Yes       | String | MIME type of the request body. You are advised to use the default value **application/json**. For APIs used to upload objects or images, the value can vary depending on the flow type. |
   +--------------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +-------------+--------------------------------------------------------------------------------------------------+-------------------------------+
   | Parameter   | Type                                                                                             | Description                   |
   +=============+==================================================================================================+===============================+
   | backups     | Array of :ref:`backups <gaussdb_11_0023__en-us_topic_0000001181244186_response_backups>` objects | Backup information.           |
   +-------------+--------------------------------------------------------------------------------------------------+-------------------------------+
   | total_count | Long                                                                                             | Total number of backup files. |
   +-------------+--------------------------------------------------------------------------------------------------+-------------------------------+

.. _gaussdb_11_0023__en-us_topic_0000001181244186_response_backups:

.. table:: **Table 4** backups

   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                                                 | Description                                                                                                        |
   +=======================+======================================================================================================+====================================================================================================================+
   | id                    | String                                                                                               | Backup ID.                                                                                                         |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | name                  | String                                                                                               | Backup name.                                                                                                       |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | begin_time            | String                                                                                               | Backup start time in the "yyyy-mm-ddThh:mm:ssZ" format.                                                            |
   |                       |                                                                                                      |                                                                                                                    |
   |                       |                                                                                                      | **T** is the separator between the calendar and the hourly notation of time. **Z** indicates the time zone offset. |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | end_time              | String                                                                                               | Backup end time in the "yyyy-mm-ddThh:mm:ssZ" format.                                                              |
   |                       |                                                                                                      |                                                                                                                    |
   |                       |                                                                                                      | **T** is the separator between the calendar and the hourly notation of time. **Z** indicates the time zone offset. |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | status                | String                                                                                               | Backup status. Value:                                                                                              |
   |                       |                                                                                                      |                                                                                                                    |
   |                       |                                                                                                      | -  **BUILDING**: Backup in progress                                                                                |
   |                       |                                                                                                      | -  **COMPLETED**: Backup completed                                                                                 |
   |                       |                                                                                                      | -  **FAILED**: Backup failed                                                                                       |
   |                       |                                                                                                      | -  **AVAILABLE**: Backup available                                                                                 |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | take_up_time          | Integer                                                                                              | Backup duration in minutes.                                                                                        |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | type                  | String                                                                                               | Backup type. Value:                                                                                                |
   |                       |                                                                                                      |                                                                                                                    |
   |                       |                                                                                                      | -  **auto**: automated full backup                                                                                 |
   |                       |                                                                                                      | -  **manual**: manual full backup                                                                                  |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | size                  | Double                                                                                               | Backup size in MB.                                                                                                 |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | datastore             | :ref:`MysqlDatastore <gaussdb_11_0023__en-us_topic_0000001181244186_response_mysqldatastore>` object | Database information.                                                                                              |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | instance_id           | String                                                                                               | DB instance ID.                                                                                                    |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+
   | description           | String                                                                                               | Description of the backup file.                                                                                    |
   +-----------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+

.. _gaussdb_11_0023__en-us_topic_0000001181244186_response_mysqldatastore:

.. table:: **Table 5** MysqlDatastore

   +-----------+--------+------------------------------------------------------------+
   | Parameter | Type   | Description                                                |
   +===========+========+============================================================+
   | type      | String | DB engine. Currently, only **gaussdb-mysql** is supported. |
   +-----------+--------+------------------------------------------------------------+
   | version   | String | DB version.                                                |
   +-----------+--------+------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 6** Response body parameters

   ========== ====== ==============
   Parameter  Type   Description
   ========== ====== ==============
   error_code String Error code.
   error_msg  String Error message.
   ========== ====== ==============

**Status code: 500**

.. table:: **Table 7** Response body parameters

   ========== ====== ==============
   Parameter  Type   Description
   ========== ====== ==============
   error_code String Error code.
   error_msg  String Error message.
   ========== ====== ==============

Example Request
---------------

.. code-block:: text

   GET https://gaussdb-mysql.eu-de.otc.t-systems.com/mysql/v3/97b026aa9cc4417888c14c84a1ad9860/backups?instance_id=ba62a0b83a1b42bfab275829d86ac0fdin07&backup_id=c0c9f155c7b7423a9d30f0175998b63bbr01&backup_type=auto&offset=0&limit=10&begin_time=2020-07-06T10:41:14+0200&end_time=2020-07-16T10:41:14+0200

Example Response
----------------

**Status code: 200**

Success.

.. code-block::

   {
     "backups" : [ {
       "id" : "1fe4feaab48f11e6654hfa163eba87e4b66u",
       "name" : "TaurusDB-e747-20200705185048266",
       "begin_time" : "2018-08-06T12:41:14+0200",
       "end_time" : "2018-08-06T12:45:14+0200",
       "take_up_time" : 2,
       "status" : "COMPLETED",
       "type" : "auto",
       "size" : 2803,
       "datastore" : {
         "type" : "gaussdb-mysql",
         "version" : "8.0"
       },
       "instance_id" : "43e4feaab48f11e89039fa163ebaa7e4br01"

     } ],
     "total_count" : 1
   }

Status Code
-----------

For details, see :ref:`Status Codes <gaussdb_10_0002>`.

Error Code
----------

For details, see :ref:`Error Codes <gaussdb_10_0003>`.
